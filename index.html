<!DOCTYPE html>
<html>
<head>
  <title>Highcharts Client-Side Export Module</title>

  <meta charset="UTF-8">

  <link rel="stylesheet" type="text/css" href="bower_components/bootstrap/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="bower_components/bootstrap/dist/css/bootstrap-theme.min.css" />
  <link rel="stylesheet" type="text/css" href="bower_components/fontawesome/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="main.css">

  <!--[if lt IE 9]>
  <script type="application/javascript" src="bower_components/respond/dest/respond.min.js"></script>
  <![endif]-->
</head>
<body id="top">

<div class="navbar navbar-default navbar-fixed-top">
<div class="container">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <a class="navbar-brand" href="#top">Highcharts Client-Side Export Module</a>
  </div>

<div>
  <ul class="nav navbar-nav">
    <li></li>
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Jump to&hellip; <span class="caret"></span></a>
      <ul class="dropdown-menu" role="menu">
        <li><a href="#dependencies">Dependencies</a></li>
        <li><a href="#installation">Installation</a></li>
        <li><a href="#usage">Usage</a></li>
        <li><a href="#reference">Reference</a></li>
        <li><a href="#compatibility">Compatibility</a></li>
        <li><a href="#license">License &amp; Credits</a></li>
      </ul>
    </li>
  </ul>

  <ul class="nav navbar-nav navbar-right">
    <li>
        <a href="https://github.com/A----/highcharts-export-clientside">
          <i class="fa fa-github fa-lg"></i> GitHub Project
        </a>
    </li>
  </ul>
</div>
</div><!-- /.container-fluid -->
</div>

<div class="jumbotron">
  <div class="container">
    <h1>Highcharts Client-Side Export Module</h1>
    <p>
      <a href="http://www.highcharts.com/">HighCharts</a> has a
      <a href="http://www.highcharts.com/docs/export-module/export-module-overview">module</a> to export generated charts to a
      file but it relies on an external server for rasterization and file download. This module, while using that one, uses HTML5
      features and other JavaScript libraries to make it work without setting up an export server.
    </p>
  </div>
</div>

<div class="container">
  <div class="panel panel-primary">
    <div class="panel-heading">Example</div>
    <div class="panel-body row">
      <div class="highcharts-container col-xs-8 col-sm-8 col-md-9" id="example-1"></div>
      <div class="col-xs-4 col-sm-4 col-md-3">
        <p>
          Use the default <a href="http://api.highcharts.com/highcharts#exporting.buttons.contextButton.menuItems">menu</a>
          <i class="fa fa-bars fa-border"></i> provided by HighCharts.
        </p>

        <p>Or the programmatically defined buttons below:</p>

        <div class="text-center">
          <div class="btn-group-vertical chart-export" data-chart-selector="#example-1">
            <button type="button" class="btn btn-default" data-type="image/svg+xml">
              <i class="fa fa-file-code-o"></i> <span class="file-format-name">SVG</span>
            </button>
            <button type="button" class="btn btn-default" data-type="image/png">
              <i class="fa fa-file-image-o"></i> <span class="file-format-name">PNG</span>
            </button>
            <button type="button" class="btn btn-default" data-type="image/jpeg">
              <i class="fa fa-file-image-o"></i> <span class="file-format-name">JPEG</span>
            </button>
            <button type="button" class="btn btn-default" data-type="application/pdf">
              <i class="fa fa-file-pdf-o"></i> <span class="file-format-name">PDF</span>
            </button>
            <button type="button" class="btn btn-default" data-type="text/csv">
              <i class="fa fa-file-text-o"></i> <span class="file-format-name">CSV</span>
            </button>
            <button type="button" class="btn btn-default" data-type="application/vnd.ms-excel">
              <i class="fa fa-file-excel-o"></i> <span class="file-format-name">XLS</span>
            </button>
          </div>
        </div>

        <p>
          <br />
          You can toy with this example in this jsFiddle:<br />
          <a class="btn btn-primary pull-right" href="http://jsfiddle.net/pscjzhe4/">
            <i class="fa fa-jsfiddle"></i>
            jsFiddle
          </a>
        </p>

      </div>
    </div>
  </div>
</div>

<hr />

<div class="container" id="dependencies">
  <p>
    By using a combination of official export module, canvas-tools module (or <a href="https://github.com/gabelerner/canvg">canvg</a>)
    and <a href="https://github.com/MrRio/jsPDF">jsPDF</a>, allow your users to export your charts client-side in SVG, PNG, JPEG or PDF,
    without privacy concerns.
  </p>

  <p>
    It also supports pseudo-official <a href="https://github.com/highslide-software/export-csv">export-csv</a> to export raw data in CSV
    and XLS. All under a unified API. Check the dependency tree below for more information.
  </p>

  <br />

  <div class="row">
    <div class="col-xs-12 col-sm-8">
      <div class="panel panel-default">
        <div class="panel-heading">Dependency tree</div>
        <div class="panel-body highcharts-container" id="dependency-tree">
        </div>
      </div>
    </div>

    <div class="col-xs-12 col-sm-4">
      <h3>Dependency tree</h3>

      <p>
        The dependency tree has been generated with HighCharts, and thus, is
        exportable!
      </p>

      <p>
        <em>
          Learn more on how to draw custom shapes with HighCharts renderer
          <a href="http://www.highcharts.com/demo/renderer">here</a>.
        </em>
      </p>

      <h3>Support</h3>

      <p>
        With this configuration (all dependencies) and on this platform, those formats
        have been detected to be supported:
      </p>

      <ul class="browser-support list-unstyled">
        <li><strong>SVG</strong> <span data-type="image/svg+xml"></span></li>
        <li><strong>PNG</strong> <span data-type="image/png"></span></li>
        <li><strong>JPEG</strong> <span data-type="image/jpeg"></span></li>
        <li><strong>PDF</strong> <span data-type="application/pdf"></span></li>
        <li><strong>CSV</strong> <span data-type="text/csv"></span></li>
        <li><strong>XLS</strong> <span data-type="application/vnd.ms-excel"></span></li>
      </ul>
    </div>
  </div>

</div>

<hr />

<div class="container" id="installation">
  <h2>Installation</h2>

  <p>To install it, you need to do the following:</p>

  <ol>
    <li>
      Download it:
      <ul>
        <li>
          using <a href="http://bower.io">Bower</a>:
          <code>bower install https://github.com/A----/highcharts-export-clientside.git</code>
        </li>
        <li>
          from <a href="https://github.com">GitHub</a>:
          <a href="https://github.com/A----/highcharts-export-clientside">https://github.com/A----/highcharts-export-clientside</a>
        </li>
      </ul>
    </li>
    <li>
      Add it to your project:
      <code class="language-html">
        &lt;script type="application/javascript" src="./lib/highcharts-export-clientside/highcharts-export-clientside.js"&gt;&lt;/script&gt;
      </code>
      along-side the dependencies you need (see dependency tree above for more information).<br />
      <br/>
      Something along those lines:
      <pre class="language-html">
&lt;!-- HighCharts --&gt;
&lt;script type="application/javascript" src="./lib/highcharts/highcharts.js"&gt;&lt;/script&gt;

&lt;!-- Other dependencies --&gt;
&lt;script type="application/javascript" src="./lib/highcharts/modules/exporting.js"&gt;&lt;/script&gt;
&lt;script type="application/javascript" src="./lib/highcharts/modules/canvas-tools.js"&gt;&lt;/script&gt;
&lt;script type="application/javascript" src="./lib/export-csv/export-csv.js"&gt;&lt;/script&gt;
&lt;script type="application/javascript" src="./lib/jspdf/dist/jspdf.min.js"&gt;&lt;/script&gt;

&lt;!-- This module, after the dependencies -->
&lt;script type="application/javascript" src="./lib/highcharts-export-clientside/highcharts-export-clientside.js">&lt;/script>
      </pre>
    </li>
    <li>There are no step 3!</li>
  </ol>
</div>

<hr />

<div class="container" id="usage">
  <h2>Usage</h2>

  <p>
    <strong>If you just want to use the menu provided by HighCharts,</strong> <em>you have nothing to do!</em>
    Just include this module after the dependencies you need but before your chart definitions.
  </p>

  <p>
    <strong>If you need to access the feature programmatically,</strong> the module adds a method
    <code class="language-javascript">exportChartLocal(options, chartOptions)</code> to the
    <code class="language-javascript">HighCharts.Chart</code> prototype. It attempts to mimic as closely as possible
    <code class="language-javascript">
      <a href="http://api.highcharts.com/highcharts#Chart.exportChart">exportChart(options, chartOptions)</a>
    </code>
    provided by the official exporting module.
  </p>

  <p>Quick snippet below:</p>

  <pre class="language-javascript">
$("#my-highcharts-container")
  .highcharts()                                 // Fetches the Chart instance associated with this container.
  .exportChartLocal({                           // All attributes are optionals (defaut type is "image/png").
    type: Highcharts.export.MIME_TYPES.JPEG     // For your convenience, MIME_TYPES are stored in an object.
  });</pre>

  <p>
    You may want to know if the current platform supports said export type. To do so, a function called
    <code class="language-javascript">supports(mimeType)</code> exists.
  </p>

  <pre class="language-javascript">
if(Highcharts.export.supports(Highcharts.export.MIME_TYPES.XLS)) {
  // Excel file format is supported!
}</pre>

  <p>
    That's all!
    <br/>
    <br/>
  </p>

  <div class="alert alert-info" role="alert">
    <strong>How can I be sure it works?</strong>

    <p>
      Fair. When possible, it first sets object a dummy URL in the HighCharts global configuration
      (<code class="language-javascript">exporting.url</code>), just in case.
      Next, it overrides official <code class="language-javascript">exportChart([&hellip;])</code>
      method with its own <code class="language-javascript">exportChartLocal([&hellip;])</code> so legacy code will still
      work.
      Finally, it changes click handlers in the menu with a custom ones. Again, just to be safe.
    </p>
  </div>
</div>

<hr />

<div class="container" id="reference">
  <h2>Reference</h2>

  <p>Hereunder, a list of defined objects and methods by this module.</p>

  <div class="row">
  <div class="col-xs-12 col-sm-12 col-md-6">
    <h3>In <code>HighCharts.Chart.prototype</code>:</h3>

    <dl class="reference-list">
      <dt><code>exportChartLocal(options, chartOptions)</code></dt>
      <dd>
        Function to download the chart. It's set to mimic
        <code><a href="http://api.highcharts.com/highcharts#Chart.exportChart">chart.exportChart</a></code>.
      </dd>
      <dd>
        <code>options</code> <i>(optional)</i>, an object containing export options. They overload those defined at chart definition.
        Supported attributes and default values are as follow:

        <pre class="language-javascript">
{
  filename: "chart",
  chartOptions: {},
  sourceWidth: &lt;chart.width&gt;,
  sourceHeight: &lt;chart.height&gt;,
  scale: 2,
  csv: {
    useLocalDecimalPoint: true,
    dateFormat: "%Y-%m-%d %H:%M:%S",
    itemDelimiter: ",",
    itemDelimiter: "\n",
  }
}</pre>
        <br />

        Attributes should follow <a href="http://api.highcharts.com/highcharts#exporting">official ones</a>:
        <ul>
          <li>
            <code>filename</code>:
            <span class="label label-default">All Formats</span> String, defaults to <code>"chart"</code>.
            Desired filename without the extension.
          </li>
          <li>
            <code>chartOptions</code>:
            <span class="label label-default">SVG, PNG, JPEG, PDF</span> Object, defaults to <code>undefined</code>.
            Default chart options, see <code>chartOptions</code> parameter.
          </li>
          <li>
            <code>sourceWidth</code>, <code>sourceHeight</code>:
            <span class="label label-default">SVG, PNG, JPEG, PDF</span> Integers, default to <code>undefined</code>.
            If not defined, takes the current width/height. Width / Height of exported <em>before</em> <code>scale</code> is applied.
            Superseeded by <code>chart.width</code> and <code>chart.height</code> if explicitly defined.
            The unit is pixels except for PDF where it is millimeters.
          </li>
          <li>
            <code>scale</code>:
            <span class="label label-default">SVG, PNG, JPEG, PDF</span> Integer, defaults to <code>2</code>.
            Multiplying factor to the dimension of the exported image.
          </li>
          <li>
            <code>csv.useLocalDecimalPoint</code>:
            <span class="label label-default">CSV, XLS</span> <span class="label label-warning">Unoffical</span>
            Boolean, defaults to <code>true</code>.
            If <code>true</code>, exported files use the current browser decimal separator. Else uses <code>.</code> (dot).
          </li>
          <li>
            <code>csv.dateFormat</code>:
            <span class="label label-default">CSV</span> String, defaults to <code>%Y-%m-%d %H:%M:%S</code>.
            Format for the dates. A format understood by <code>Highcharts.dateFormat([&hellip;])</code>.
          </li>
          <li>
            <code>csv.itemDelimiter</code>:
            <span class="label label-default">CSV</span> String, defaults to <code>,</code>.
            Character used to separate fields.
          </li>
          <li>
            <code>csv.lineDelimiter</code>:
            <span class="label label-default">CSV</span> String, defaults to <code>\n</code>.
            Character used as new line.
          </li>
        </ul>

      </dd>
      <dd>
        <code>chartOptions</code> <i>(optional)</i> is an object that will be passed through <code>chart.getSVG(chartOptions)</code>.
        It is used to overload rendering options prior to SVG generation. For instance, setting a different background,
        changing legend position, etc.
      </dd>
      <dd>
        Return value is undefined but an error might be thrown if the provided type is not supported or
        an error occured during the export.
      </dd>

      <dt><code>exportChart(options, chartOptions)</code></dt>
      <dd>
        Alias to <code>exportChartLocal(options, chartOptions)</code> for legacy code use.
      </dd>
    </dl>
  </div>

  <div class="col-xs-12 col-sm-12 col-md-6">
    <h3>In <code>HighCharts.export</code>:</h3>

    <dl class="reference-list">
      <dt><code>MIME_TYPES</code></dt>
      <dd>
        An object containing the <a href="http://en.wikipedia.org/wiki/Internet_media_type">MIME types</a> of
        exportable formats.
      </dd>
      <dd>
        Extensive key-value pairs are as follow:
        <ul>
          <li><code>SVG</code>: <code>image/svg+xml</code></li>
          <li><code>PNG</code>: <code>image/png</code></li>
          <li><code>JPEG</code>: <code>image/jpeg</code></li>
          <li><code>PDF</code>: <code>application/pdf</code></li>
          <li><code>CSV</code>: <code>text/csv</code></li>
          <li><code>XLS</code>: <code>application/vnd.ms-excel</code></li>
        </ul>
      </dd>

      <dt><code>supports(mimeType)</code></dt>
      <dd>
        A function indicating if the supplied MIME type is supported on the current configuration. Supported types
        are computed at evaluation time, meaning that if you include a dependency dynamically or after this module,
        this will not return a correct value.
      </dd>
      <dd>
        <code>mimeType</code> is expected to be a string. For available values, see <code>MIME_TYPES</code>.
      </dd>
      <dd>
        Returns a boolean, <code>true</code> if the provided MIME type is supported.
      </dd>
    </dl>

    <div class="vertical-separator hidden-xs hidden-sm"></div>

    <h3 id="compatibility">Compatibility</h3>

    <div class="alert alert-warning">
      <strong>Read carefully</strong> as compatibility isn't assured on every browser.
    </div>

    <p>
      This module has been tested under <strong>Google Chrome</strong>, <strong>Opera</strong> (webkit-based)
      and <strong>Mozilla Firefox.</strong>
    </p>

    <p><strong>Internet Explorer 10-11</strong> is still a work in progress.</p>
  </div>
  </div>
</div>

<hr />

<div class="container" id="license">
  <h2>License &amp; Credits</h2>

  <div class="row">
  <div class="col-xs-12 col-sm-6">
    <p class="clearfix">
      <span class="pull-left fa-stack fa-lg">
        <i class="fa fa-copyright fa-stack-2x"></i>
        <i class="fa fa-ban fa-stack-2x"></i>
      </span>
      This module is releasing under the Unlicense license. A copy of which can be found <a href="http://unlicense.org">here.</a>
    </p>
  </div>
  <div class="col-xs-12 col-sm-6">
    <p>Written with the help of the following resources:</p>

    <ul>
      <li>
        that
        <a href="http://stackoverflow.com/questions/25630811/export-highcharts-to-pdf-using-javascript-and-local-server-no-internet-connec">
        Stack Overflow Q/A</a> and this <a href="https://github.com/leighquince/HighChartLocalExport/">snippet/project</a> by
        @<a href="https://github.com/leighquince">leighquince</a>;
      </li>
      <li>
        this
        <a href="http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/exporting/offline-download/">
        JSFiddle</a> from the official <a href="http://www.highcharts.com/docs/export-module/export-module-overview">HighCharts
        documentation</a>.
      </li>
    </ul>
  </div>
  </div>
</div>

<div class="footer">
<div class="container">
</div>
</div>

<script type="application/javascript" src="bower_components/jquery/dist/jquery.min.js"></script>
<script type="application/javascript" src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script type="application/javascript">
  // Small fix for Jump to… to work properly
  // https://github.com/twbs/bootstrap/issues/1768
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

<script type="application/javascript" src="bower_components/highcharts/highcharts.js"></script>
<script type="application/javascript" src="bower_components/highcharts/modules/exporting.js"></script>
<script type="application/javascript" src="bower_components/highcharts/modules/canvas-tools.js"></script>
<script type="application/javascript" src="bower_components/export-csv/export-csv.js"></script>
<script type="application/javascript" src="bower_components/jspdf/dist/jspdf.min.js"></script>

<script type="application/javascript" src="bower_components/highcharts-export-clientside/highcharts-export-clientside.js"></script>

<script type="application/javascript" src="js/example1.js"></script>
<script type="application/javascript" src="js/dependency-tree.js"></script>

<script type="application/javascript">
$(".chart-export").each(function() {
  var jThis = $(this),
      chartSelector = jThis.data("chartSelector"),
      chart = $(chartSelector).highcharts();

  $("*[data-type]", this).each(function() {
    var jThis = $(this),
        type = jThis.data("type");
    if(Highcharts.export.supports(type)) {
      jThis.click(function() {
        chart.exportChartLocal({ type: type });
      });
    }
    else {
      jThis.attr("disabled", "disabled");
    }
  });
});

$(".browser-support *[data-type]").each(function() {
  var jThis = $(this);
  if(Highcharts.export.supports(jThis.data("type"))) {
    jThis.addClass("text-success");
    jThis.html('<span class="glyphicon glyphicon-ok"></span>');
  }
  else {
    jThis.addClass("text-danger");
    jThis.html('<span class="glyphicon glyphicon-remove"></span>');
  }
});
</script>

<script type="application/javascript">

</script>

</body>
</html>
